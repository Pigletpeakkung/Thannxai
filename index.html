<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Thanats's Portfolio</title>
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="apple-touch-icon" href="/assets/images/logo192.png">
  
  <!-- Tailwind CSS -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  
  <!-- Fonts -->
  <link href="https://fonts.cdnfonts.com/css/longsile" rel="stylesheet">
  <link href="https://fonts.cdnfonts.com/css/thegoodmonolith" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=PP+Neue+Montreal&display=swap" rel="stylesheet">
  
  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">
  
  <!-- EmailJS -->
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3.10.0/dist/email.min.js"></script>
  
  <!-- Alpine.js -->
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.10.5/dist/cdn.min.js"></script>
  
  <!-- GSAP and Plugins -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.3/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/CustomEase.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/TextPlugin.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrambleTextPlugin.min.js"></script>
  <script src="https://unpkg.com/split-text-js@1.0.2/dist/splittext.min.js"></script>

  <!-- Custom CSS -->
  <link href="/assets/css/custom.css" rel="stylesheet">
</head>
<body class="text-white font-sans antialiased overflow-x-hidden" x-data="portfolioApp()">
  <!-- ... Rest of the HTML as provided ... -->
  
  <!-- Update Background Frame and Images in CSS (moved to custom.css) -->
  <div class="background-frame"></div>
  <div class="background-image default" id="default-bg"></div>
  <div class="background-image cultural" id="cultural-bg"></div>
  <div class="background-image fusion" id="fusion-bg"></div>
  <div class="background-image heritage" id="heritage-bg"></div>
  <div class="bottom-gradient"></div>

  <!-- ... Rest of the sections ... -->

  <script>
    // Alpine.js Logic
    document.addEventListener('alpine:init', () => {
      Alpine.data('portfolioApp', () => ({
        mobileMenuOpen: false,
        scrolled: false,
        formStatus: null,
        typedText: '',

        scrollToSection(id) {
          const element = document.getElementById(id);
          if (element) {
            element.scrollIntoView({ behavior: 'smooth' });
            this.mobileMenuOpen = false;
          }
        },

        init() {
          // Typing animation
          const text = 'Thanatsitt';
          let i = 0;
          const typeWriter = () => {
            if (i < text.length) {
              this.typedText += text.charAt(i);
              i++;
              setTimeout(typeWriter, 100);
            }
          };
          typeWriter();

          // Scroll Progress Bar
          window.addEventListener('scroll', () => {
            const progress = document.getElementById('scroll-progress');
            if (progress) {
              const height = document.body.scrollHeight - window.innerHeight;
              const scrolled = (window.scrollY / height) * 100;
              progress.style.width = scrolled + '%';
            }
          });

          // EmailJS Form Submission
          emailjs.init(process.env.EMAILJS_USER_ID || 'YOUR_USER_ID'); // Use env variable or placeholder
          const form = document.getElementById('contact-form');
          if (form) {
            form.addEventListener('submit', (e) => {
              e.preventDefault();
              emailjs.sendForm('YOUR_SERVICE_ID', 'YOUR_TEMPLATE_ID', form)
                .then(() => {
                  this.formStatus = 'Message sent successfully!';
                  form.reset();
                  setTimeout(() => this.formStatus = null, 5000);
                }, (error) => {
                  this.formStatus = 'Failed to send message. Please try again.';
                  console.error('EmailJS Error:', error);
                });
            });
          }

          // Dynamic Footer Year
          const yearElement = document.getElementById('current-year');
          if (yearElement) {
            yearElement.textContent = new Date().getFullYear();
          }
        }
      }));
    });

    // GSAP and Interactive Text Animation
    gsap.registerPlugin(CustomEase, SplitText, ScrambleTextPlugin);

    document.addEventListener("DOMContentLoaded", function () {
      CustomEase.create("customEase", "0.86, 0, 0.07, 1");
      CustomEase.create("mouseEase", "0.25, 0.1, 0.25, 1");

      document.fonts.ready.then(() => {
        initializeAnimation();
      });

      // ... Rest of GSAP logic as provided ... 

      // Card Flip for Skills Section (Fixed Syntax Error)
      document.querySelectorAll('.card-container').forEach(card => {
        card.addEventListener('click', () => {
          card.classList.toggle('flipped');
        });
        card.addEventListener('keydown', e => {
          if (e.key === 'Enter' || e.key === 'Space') {
            e.preventDefault();
            card.classList.toggle('flipped');
          }
        });
      });

      // Lazy Load Images (Remove if no img[data-src] exists)
      // Commenting out since no images use data-src
      /*
      const lazyImages = document.querySelectorAll('img[data-src]');
      const imageObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const img = entry.target;
            img.src = img.dataset.src;
            img.removeAttribute('data-src');
            observer.unobserve(img);
          }
        });
      }, { rootMargin: '0px 0px 200px 0px' });
      lazyImages.forEach(img => imageObserver.observe(img));
      */

      // Optimize Scroll Event Listener
      let lastScroll = 0;
      let ticking = false;

      window.addEventListener('scroll', () => {
        if (!ticking) {
          window.requestAnimationFrame(() => {
            lastScroll = window.scrollY;
            ticking = false;
          });
          ticking = true;
        }
      });

      // Accessibility: Skip to Content Link
      document.addEventListener('keydown', e => {
        if (e.key === 'Tab' && document.activeElement === document.body) {
          const skipLink = document.createElement('a');
          skipLink.href = '#home';
          skipLink.textContent = 'Skip to main content';
          skipLink.className = 'sr-only focus:not-sr-only bg-yellow-400 text-black p-2 rounded absolute top-4 left-4 z-50';
          document.body.prepend(skipLink);
          skipLink.focus();
          skipLink.addEventListener('blur', () => skipLink.remove());
        }
      });

      // Prevent Double Tap Zoom on Mobile
      document.addEventListener('touchstart', (e) => {
        if (e.touches.length > 1) {
          e.preventDefault();
        }
      }, { passive: false });

      // Service Worker Registration
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then(reg => console.log('Service Worker registered:', reg))
            .catch(err => console.error('Service Worker registration failed:', err));
        });
      }
    });
  </script>
</body>
</html>
